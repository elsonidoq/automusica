\documentclass[a4paper,11pt]{book}
%\usepackage{ml2k}
%\usepackage{epsf}
%\usepackage{mlapa}
%\usepackage[pdftex, colorlinks=true, citecolor=black, citebordercolor={.99 .99 .99}, linkbordercolor={.99 .99 .99}, pdfborder={0 0 1 [3]}]{hyperref}
\usepackage[pdftex, citebordercolor={.99 .99 .99}, linkbordercolor={.99 .99 .99}, pdfborder={0 0 1 [3]}]{hyperref}

\usepackage[fixlanguage]{babelbib}
\selectbiblanguage{spanish}

\usepackage[spanish, activeacute]{babel}
\selectlanguage{spanish}

% PRINT version
%\setlength{\oddsidemargin}{-20pt}
%\setlength{\evensidemargin}{-20pt}
%\setlength{\marginparwidth}{57pt}
%\setlength{\footskip}{30pt}
%\addtolength{\textwidth}{146pt}

% BOOK version
\setlength{\oddsidemargin}{53pt}
\setlength{\evensidemargin}{53pt}
\setlength{\marginparwidth}{57pt}
\setlength{\footskip}{30pt}


\usepackage[sort]{natbib}
\usepackage{psfrag}
\usepackage{fancyhdr}
\usepackage{appendix}
\usepackage{layout} 
\usepackage{graphicx} % para incluir graficos
\usepackage{amsmath} 
\usepackage{amsthm} % para escribir teoremas lindos
\usepackage{amsfonts} % para tener el simbolo de los numeros reales
\usepackage{color}  % colores de las fuentes

\usepackage{listings} % algoritmos
\lstdefinelanguage{chanfle}{	    
 	 morecomment=[l]{//},
 	 morecomment=[s]{/*}{*/},
   literate={:=}{{$\gets$}}1
   					{<-}{{$\gets$}}1
            {/not}{{$\neg$}}1
            {/and}{{$\land$}}2
            {/andThen}{{$\land_L$}}2
            {/or}{{$\lor$}}2
            {/orThen}{{$\lor_L$}}2
            {/imp}{{$\Rightarrow$}}2
            {/impThen}{{$\Rightarrow_L$}}2
            {/conjVacio}{$\emptyset$}1
            {/alpha}{$\alpha$}1
            {/alfa}{$\alpha$}1
            {->}{$\rightarrow$}2
            {NULL}{\sc{null}}4,
   keywords={if,for,then,else,while,fi,wend,true,false,var,case,of,esac,in,out,inout},
}

\lstnewenvironment{algoritmo}{}{}

\lstset{
	language=chanfle,
	basicstyle=\small,
	flexiblecolumns=false,
	basewidth={0.5em,0.45em},
	keywordstyle=\bfseries,
	tabsize=4
}

% Redefine plain page style
\fancypagestyle{plain}{
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\fancyfoot[LE,RO]{\thepage}
}

% Code for creating empty pages
% No headers on empty pages before new chapter
\makeatletter
\def\cleardoublepage{\clearpage\if@twoside \ifodd\c@page\else
    \hbox{}
    \thispagestyle{plain}
    \newpage
    \if@twocolumn\hbox{}\newpage\fi\fi\fi}
\makeatother \clearpage{\pagestyle{plain}\cleardoublepage}

% Define pagestyle
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\chaptermark}[1]{\markboth{ \emph{#1}}{}}
\fancyhead[LO]{}
\fancyhead[RE]{\leftmark}
\fancyfoot[LE,RO]{\thepage}

% Detalle de la TOC
\setcounter{tocdepth}{1}


\theoremstyle{definition} \newtheorem{axiom}{Axioma}
\theoremstyle{theorem} \newtheorem{teorema}{Teorema}

\begin{document}
\bibliographystyle{plainnat}
\bibpunct{(}{)}{,}{a}{,}{,}

\makeatother
\newcommand{\Nat}{\mathbb{N}}
% intervalo melodico
\newcommand{\IM}[1]{\underline{#1}}
\newcommand{\cita}{\textcolor{red}{cita}}
\newcommand{\alert}[1]{\footnote{\textcolor{red}{#1}}}
\newcommand{\red}[1]{\textcolor{red}{#1}}

%\newcommand{\alert}[1]{\textcolor{red}{#1}}
\newcommand{\mycomment}[1]{\textcolor{blue}{#1}\newline}
%\renewcommand{\comment}[1]{\ }
\theoremstyle{definition} \newtheorem{definition}{Definici'on}


\newcommand{\defaultAlignment}{center}
\newcommand{\defaultWidth}{12.5cm}
\newcommand{\defaultPosition}{h}
\newenvironment{imagen}{
\let\File\empty
\let\Desc\empty
\let\LabelName\empty
\let\Width\textwidth
\let\Alignment\defaultAlignment
\let\Position\defaultPosition
}{
    \begin{figure}[\Position]
    \begin{\Alignment}
    \includegraphics[width=\Width]{\File}
    \caption{\Desc}
    \label{\LabelName}
    \end{\Alignment}
    \end{figure}

}

\newcommand{\position}[1]{\def\Position{#1}}
\newcommand{\file}[1]{\def\File{#1}}
\newcommand{\desc}[1]{\def\Desc{#1}}
\newcommand{\labelname}[1]{\def\LabelName{#1}}
\newcommand{\width}[1]{\def\Width{#1}}
\newcommand{\alignment}[1]{\def\Alignment{#1}}


%\begin{abstract}
%asd
%\end{abstract}

\frontmatter

%\include{title}
\include{caratula_dm}
%\include{agradecimientos}
%\include{abstract}
%\include{msc_titlepage}
%\include{msc_preface}
%\include{msc_summary}

% Remove parskip for toc
\setlength{\parskip}{0ex plus 0.5ex minus 0.2ex}
\tableofcontents

\mainmatter
% Adjustments headers
\fancyhead[LO]{\leftmark}
\fancyhead[RE]{\emph{Cap\'itulo \thechapter}}


\chapter{Introducci\'on}
\input{introduction}
\input{state_of_the_art}
\chapter{Background}
\label{cap:background}
\input{musical_introduction}
\input{maths_bg}
\chapter{Modelos nota a nota}
\label{cap:notenote}
\input{note_note_models_intro}
\input{rythm_model}
\input{harmonic_context}
\input{contour_model}
\input{compound_process}
\chapter{Modelos jer\'arquicos}
\label{cap:jerar}
\label{cap:modelos_jerarquicos}
\input{phrases}
\input{motif}
\chapter{Experimentos}
\label{cap:experiments}
\input{experiments}
\input{results}
\input{further_work}

%\appendix
%\noappendicestocpagenum
%\addappheadtotoc
%
%% Adjustments headers
%\pagestyle{fancy}
%\fancyhead[LO]{\leftmark}
%\fancyhead[RE]{\emph{Ap\'endice \thechapter}}
%\renewcommand{\headrulewidth}{0.5pt}
%
%\input{programming}

%\bibliographystyle{apalike}
\bibliography{tesis}
\end{document}

